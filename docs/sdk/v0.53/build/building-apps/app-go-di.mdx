---
title: "Overview of app_di.go"
description: "Version: v0.53"
---

<Note>
  The Cosmos SDK allows much easier wiring of an `app.go` thanks to [runtime](/v0.53/build/building-apps/runtime) and app wiring. Learn more about the rationale of App Wiring in [ADR-057](/v0.53/build/architecture/adr-057-app-wiring).
</Note>

<Note>
  * [What is `runtime`?](/v0.53/build/building-apps/runtime)
  * [Depinject documentation](/v0.53/build/packages/depinject)
  * [Modules depinject-ready](/v0.53/build/building-modules/depinject)
  * [ADR 057: App Wiring](/v0.53/build/architecture/adr-057-app-wiring)
</Note>

This section is intended to provide an overview of the `SimApp` `app_di.go` file with App Wiring.

## `app_config.go`[​](#app_configgo "Direct link to app_configgo")

The `app_config.go` file is the single place to configure all modules parameters.

1. Create the `AppConfig` variable:

   simapp/app\_config.go

   ```
   loading...
   ```

   [See full example on GitHub](https://github.com/cosmos/cosmos-sdk/blob/v0.53.0-rc.2/simapp/app_config.go#L289-L303)

   Where the `appConfig` combines the [runtime](/v0.53/build/building-apps/runtime) configuration and the (extra) modules configuration.

   simapp/app\_di.go

   ```
   loading...
   ```

   [See full example on GitHub](https://github.com/cosmos/cosmos-sdk/blob/v0.53.0-rc.2/simapp/app_di.go#L113-L161)

2. Configure the `runtime` module:

   In this configuration, the order at which the modules are defined in PreBlockers, BeginBlocks, and EndBlockers is important. They are named in the order they should be executed by the module manager.

   simapp/app\_config.go

   ```
   loading...
   ```

   [See full example on GitHub](https://github.com/cosmos/cosmos-sdk/blob/v0.53.0-rc.2/simapp/app_config.go#L103-L188)

3. Wire the other modules:

   Next to runtime, the other (depinject-enabled) modules are wired in the `AppConfig`:

   simapp/app\_config.go

   ```
   loading...
   ```

   [See full example on GitHub](https://github.com/cosmos/cosmos-sdk/blob/v0.53.0-rc.2/simapp/app_config.go#L103-L286)

   Note: the `tx` isn't a module, but a configuration. It should be wired in the `AppConfig` as well.

   simapp/app\_config.go

   ```
   loading...
   ```

   [See full example on GitHub](https://github.com/cosmos/cosmos-sdk/blob/v0.53.0-rc.2/simapp/app_config.go#L222-L227)

See the complete `app_config.go` file for `SimApp` [here](https://github.com/cosmos/cosmos-sdk/blob/v0.53.0-rc.2/simapp/app_config.go).

### Alternative formats[​](#alternative-formats "Direct link to Alternative formats")

<Check>
  The example above shows how to create an `AppConfig` using Go. However, it is also possible to create an `AppConfig` using YAML, or JSON. The configuration can then be embed with `go:embed` and read with [`appconfig.LoadYAML`](https://pkg.go.dev/cosmossdk.io/core/appconfig#LoadYAML), or [`appconfig.LoadJSON`](https://pkg.go.dev/cosmossdk.io/core/appconfig#LoadJSON), in `app_di.go`.

  ```
  //go:embed app_config.yamlvar (    appConfigYaml []byte    appConfig = appconfig.LoadYAML(appConfigYaml))
  ```
</Check>

```
modules:  - name: runtime    config:      "@type": cosmos.app.runtime.v1alpha1.Module      app_name: SimApp      begin_blockers: [staking, auth, bank]      end_blockers: [bank, auth, staking]      init_genesis: [bank, auth, staking]  - name: auth    config:      "@type": cosmos.auth.module.v1.Module      bech32_prefix: cosmos  - name: bank    config:      "@type": cosmos.bank.module.v1.Module  - name: staking    config:      "@type": cosmos.staking.module.v1.Module  - name: tx    config:      "@type": cosmos.tx.module.v1.Module
```

A more complete example of `app.yaml` can be found [here](https://github.com/cosmos/cosmos-sdk/blob/release/v0.53.x/simapp/example_app.yaml).

## `app_di.go`[​](#app_digo "Direct link to app_digo")

`app_di.go` is the place where `SimApp` is constructed. `depinject.Inject` automatically wires the app modules and keepers when provided with an application configuration (`AppConfig`). `SimApp` is constructed upon calling the injected `*runtime.AppBuilder` with `appBuilder.Build(...)`. In short `depinject` and the [`runtime` package](/v0.53/build/building-apps/runtime) abstract the wiring of the app, and the `AppBuilder` is the place where the app is constructed. [`runtime`](/v0.53/build/building-apps/runtime) takes care of registering the codecs, KV store, subspaces and instantiating `baseapp`.

simapp/app\_di.go

```
loading...
```

[See full example on GitHub](https://github.com/cosmos/cosmos-sdk/blob/v0.53.0-rc.2/simapp/app_di.go#L100-L270)

<Warning>
  When using `depinject.Inject`, the injected types must be pointers.
</Warning>

### Advanced Configuration[​](#advanced-configuration "Direct link to Advanced Configuration")

In advanced cases, it is possible to inject extra (module) configuration in a way that is not (yet) supported by `AppConfig`. In this case, use `depinject.Configs` for combining the extra configuration, and `AppConfig` and `depinject.Supply` for providing the extra configuration. More information on how `depinject.Configs` and `depinject.Supply` function can be found in the [`depinject` documentation](https://pkg.go.dev/cosmossdk.io/depinject).

simapp/app\_di.go

```
loading...
```

[See full example on GitHub](https://github.com/cosmos/cosmos-sdk/blob/v0.53.0-rc.2/simapp/app_di.go#L114-L162)

### Registering non app wiring modules[​](#registering-non-app-wiring-modules "Direct link to Registering non app wiring modules")

It is possible to combine app wiring / depinject enabled modules with non-app wiring modules. To do so, use the `app.RegisterModules` method to register the modules on your app, as well as `app.RegisterStores` for registering the extra stores needed.

```
// ....app.App = appBuilder.Build(db, traceStore, baseAppOptions...)// register module manuallyapp.RegisterStores(storetypes.NewKVStoreKey(example.ModuleName))app.ExampleKeeper = examplekeeper.NewKeeper(app.appCodec, app.AccountKeeper.AddressCodec(), runtime.NewKVStoreService(app.GetKey(example.ModuleName)), authtypes.NewModuleAddress(govtypes.ModuleName).String())exampleAppModule := examplemodule.NewAppModule(app.ExampleKeeper)if err := app.RegisterModules(&exampleAppModule); err != nil {    panic(err)}// ....
```

<Warning>
  When using AutoCLI and combining app wiring and non-app wiring modules. The AutoCLI options should be manually constructed instead of injected. Otherwise it will miss the non depinject modules and not register their CLI.
</Warning>

### Complete `app_di.go`[​](#complete-app_digo "Direct link to complete-app_digo")

<Check>
  Note that in the complete `SimApp` `app_di.go` file, testing utilities are also defined, but they could as well be defined in a separate file.
</Check>

simapp/app\_di.go

```
loading...
```

[See full example on GitHub](https://github.com/cosmos/cosmos-sdk/blob/v0.53.0-rc.2/simapp/app_di.go)
